# Create new Data Table with Primary Key and Foreign key in relation to Allergies data table. Medicines column should not be null.
Create Table Data 
(ID INT Primary Key,
Hospital_Name VARCHAR,
Date_of_Admission Date,
Medicines VARCHAR NOTNULL,
Foreign Key (Date_of_Admission), References Allergies(Date_of_Admission);

#Add 3 rows to the table 
INSERT INTO Data (ID, Hospital_Name, Date_of_Admission, Medicines)
Values (1, Sakra, 14/10/2024, Paracetamol)
(2, Rainbow, 20/5/2024, Panadol)
(3, Vivan, 6/6/2024, Tramadol)

# Add another column to the newly created table
ALTER TABLE Data Add Disease;

# Delete the recently added column 
ALTER TABLE Data Drop Disease;

# Rename the table from Data to Hospital Details
ALTER TABLE Data RENAME TO Hospital_Details;

# Rename column Medicines to Medications
ALTER TABLE Data Rename Medicines TO Medications;

# Delete specific rows. Delete record for the patient who used Tramadol drug.
DELETE FROM Hospital_Details
where Medicines = 'Tramadol';

#Remove all rows in data table but retain column names
TRUNCATE TABLE Data;

# Delete all rows in data table by retaining column namnes
DELETE TABLE Hospital_Details;

# Delete the entire data table permanently from SQL server. DROP functionality output cannot be rolled back
DROP TABLE Hospital_Details;

# Create Dummy table same as Hospital_Details (or) insert all columns, rows from Hospital_Details table to Dummy table.
Create TABLE Dummy
AS Select * From Hospital_Details;

# Add rows from Hospital table to Dummy Table
INSERT INTO Dummy2 (ID, Name, date_of_adnission, BMI, Medicines)
select ID, Name, date_of_adnission, BMI, Medicines from Data;

-------------------------------------------------------------------------------------------------------------------------------------------------------------------

Patients Table : Patient ID, First Name, Last Name, Gender, Birth Date, City, Province ID, Allergies, Height, Weight.
Province Names: Province ID, Province Name

# Replace all null values in allergies column with NKA. 
UPDATE Patients
SET allergies = 'NKA' where allergies ISNULL;

# Show first name and last name merged into one column to show their full name. 
Hint: Give space between special charecters ' ' to generate space between first name and last name.
SELECT
CONCAT(first_name,' ',last_name) AS full_name
FROM patients;

Or use below formla also for concatenate purpose.
SELECT first_name || ' ' || last_name
FROM patients;

#Show first name, last name, and the full province name of each patient.
SELECT
  first_name,
  last_name,
  province_names.province_name
FROM patients
  left join province_names ON province_names.province_id = patients.province_id;

# Show how many patients have a birth_date with 2010 as the birth year.
SELECT count(patient_id) AS total_patients
FROM patients
WHERE
  year(birth_date) = 2010;

or Use below logic for the same purpose.
SELECT count(first_name) AS total_patients
FROM patients
WHERE
  birth_date >= '2010-01-01'
  AND birth_date <= '2010-12-31'

# Show the first_name, last_name, and height of the patient with the greatest height.
SELECT first_name, last_name, max(height) as Height FROM patients;

# Show all columns for patients who have one of the following patient_ids as 1,45,534,879,1000.
SELECT * FROM patients
where patient_id in ('1', '45', '534', '879', '1000');

# Show the total number of admissions
SELECT count(*) as Total_Admissions FROM admissions;

# Show all the columns from admissions where the patient was admitted and discharged on the same day.
SELECT * FROM admissions
where admission_date = discharge_date;

# Show the patient id and the total number of admissions for patient_id 579.
SELECT patient_id, count(admission_date) as Number_of_admissions FROM admissions
where patient_id = 579;

# Based on the cities that our patients live in, show unique cities that are in province_id 'NS'?
select distinct(city) from patients
where province_id = 'NS';

